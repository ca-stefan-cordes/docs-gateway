= Rate Limiting
ifndef::env-site,env-github[]
include::_attributes.adoc[]
endif::[]
:imagesdir: ../assets/images

Control incoming API traffic by limiting the number of requests that the API can receive within a given period of time.

== Definition

[source]
----
- policyRef:
    name: rate-limiting-flex
  config:
    rateLimits: <array> // REQUIRED
      - maximumRequests: <int> // REQUIRED
        timePeriodInMilliseconds: <int> // REQUIRED
    keySelector: <string> // REQUIRED
    exposeHeaders: <bool> // REQUIRED
    clusterizable = <bool> // OPTIONAL, default: false
    allowNotMatched: <bool> // OPTIONAL, default: false
----

== Example

The following defines a rate limit of three requests every six seconds:

[source] 
----
- policyRef:
    name: rate-limiting-flex
  config:
    rateLimits:
      - maximumRequests: 3
        timePeriodInMilliseconds: 6000
    keySelector: "#[attributes.queryParams['identifier']]"
    exposeHeaders: true
----

Setting `exposeHeaders` to `true` specifies that `x-ratelimit` headers should be exposed in the response.
