= Flex Gateway Resource Sizing
ifndef::env-site,env-github[]
include::_attributes.adoc[]
endif::[]
:imagesdir: ../assets/images
:table-caption!:

This document provides recommendations for sizing Flex Gateway resources. As the bridge between your application and backend services, Flex Gateway plays a critical role in managing and controlling the interactions between these components. Therefore, appropriate resource sizing is important for optimal performance and reliability.

The two key factors to consider are the number of APIs deployed, and the number of policies applied. Additional considerations include the throughput of transactions at peak times, and the payload size of the data being sent through the APIs.

Resource sizing recommendations are guidelines based on the following scenarios. Additional benchmarking adjustments should be performed to satisfy specific performance requirements.

== 20 APIs, 2 Policies

- Flex Gateway deployed in a Kubernetes cluster
- 2 replicas
- Load distributed among 200 users
- 100 transactions per second
- Message Logging and JWT Validation policies applied

// In this use case, Flex Gateway running in Kubernetes deployments has computing limits set at cpu=2000m, memory=2Gi, and request limits set at cpu=250m, memory=512Mi. It uses two replicas. 20 APIs have been deployed, with a load distributed among 200 users, handling 100 transactions per second.

.Sizing recommendations
[cols="1a, 1a"]
|===
|CPU (m) |Memory (MiB)

| xx
| xx

|===

// .Message Logging and JWT Validation policies applied:
// [cols="1a,1a,1a,1a,1a,1a"]
// |===
// |Pods |Response Size |Throughput |Average Response Time |Average CPU Usage |Average Memory Used (MIB)
//
// |2
// |1kb
// |104
// |205
// |0.074
// |500.5
//
// |3
// |1kb
// |93.2
// |204
// |0.064
// |519
//
// |2
// |100kb
// |100
// |206
// |0.0854
// |524
//
// |3
// |100kb
// |80.4
// |206
// |0.0707
// |517
// |===
//

== 100 APIs, 2 Policies

- Flex Gateway deployed in a Kubernetes cluster
- 2 replicas
- Load distributed among 200 users
- 200 transactions per second
- Message Logging and JWT Validation policies applied

// This scenario has a gateway with computing settings in kubernetes-deployments limits for cpu=2cores, memory=2GiB and requests cpu=250m, memory=512MiB and replica=2. The test will be to deploy in this gateway 100 APIs distributed load in 200 users and 200 transactions per second.

.Sizing recommendations
[cols="1a, 1a"]
|===
|CPU (m) |Memory (MiB)

| xx
| xx

|===

== 200 APIs, 2 Policies

- Flex Gateway deployed in a Kubernetes cluster
- 2 replicas
- Load distributed among 200 users
- 200 transactions per second
- Message Logging and JWT Validation policies applied

// This scenario has a gateway with computing settings in kubernetes-deployments limits for cpu=2cores, memory=4Gi and requests cpu=0.250, memory=512MiB and replica=2. The test will be to deploy in this gateway 200 APIs distributed load in 200 users and 200 transactions per second.

.Sizing recommendations
[cols="1a, 1a"]
|===
|CPU (m) |Memory (MiB)

| xx
| xx

|===

== 400 APIs, 2 Policies

- Flex Gateway deployed in a Kubernetes cluster
- 2 replicas
- Load distributed among 500 users
- 500 transactions per second
- Message Logging and JWT Validation policies applied

// This scenario has a gateway with computing settings in kubernetes-deployments limits for cpu=2, memory=8GiB  and requests cpu=0.250, memory=512MiB and replica=2. The test will be to deploy in this gateway 400 APIs distributed load in 500 users and 500 transactions per second.

.Sizing recommendations
[cols="1a, 1a"]
|===
|CPU (m) |Memory (MiB)

| xx
| xx

|===

== 500 APIs, 2 Policies

- Flex Gateway deployed in a Kubernetes cluster
- 2 replicas
- Load distributed among 1000 users
- 200 transactions per second
- Message Logging and JWT Validation policies applied

// This scenario has a gateway with computing settings in kubernetes-deployments limits for cpu=2, memory=12GiB and requests cpu=250m, memory=512MiB  and replica=2. The test will be to deploy in this gateway 500 APIs distributed load in 1000 users and 200 transactions per second.

.Sizing recommendations
[cols="1a, 1a"]
|===
|CPU (m) |Memory (MiB)

| xx
| xx

|===